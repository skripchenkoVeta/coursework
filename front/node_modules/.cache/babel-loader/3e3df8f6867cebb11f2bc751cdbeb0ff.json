{"ast":null,"code":"import { makeAutoObservable } from \"mobx\";\nimport { deleteDeviceFromBasket } from \"../http/deviceAPI\";\nexport default class BasketStoreStore {\n  constructor() {\n    this._totalPrice = 0;\n    this._basket = [];\n    makeAutoObservable(this);\n  }\n\n  async setDeleteItemBasket(device, isAuth = false) {\n    if (isAuth) {\n      await deleteDeviceFromBasket(device.id).then(() => {\n        this._basket = this._basket.filter(item => item.id !== device.id);\n        this._totalPrice -= device.price * device.count;\n      });\n    } else {\n      this._basket = this._basket.filter(item => item.id !== device.id);\n      this._totalPrice -= device.price * device.count;\n      localStorage.setItem(\"basket\", JSON.stringify(this._basket));\n    }\n  }\n\n  setBasket(item, isAuth = false) {\n    const checkDeviceInBasket = this._basket.findIndex(device => device.id === item.id);\n\n    if (checkDeviceInBasket < 0) {\n      this._basket = [...this._basket, {\n        count: 1,\n        ...item\n      }];\n      let totalPrice = 0;\n\n      this._basket.forEach(device => totalPrice += Number(device.price * device.count));\n\n      this._totalPrice = totalPrice;\n    }\n\n    if (!isAuth) {\n      localStorage.setItem(\"basket\", JSON.stringify(this._basket));\n    }\n  }\n\n  setDeleteAllDeviceFromBasket() {\n    this._totalPrice = 0;\n    return this._basket = [];\n  }\n\n  setCountDevice(deviceId, action, isAuth = false) {\n    const itemInd = this._basket.findIndex(item => item.id === deviceId);\n\n    const itemInState = this._basket.find(device => device.id === deviceId);\n\n    if (action === \"+\") {\n      const newItem = { ...itemInState,\n        count: ++itemInState.count\n      };\n      this._basket = [...this._basket.slice(0, itemInd), newItem, ...this._basket.slice(itemInd + 1)];\n    } else {\n      const newItem = { ...itemInState,\n        count: itemInState.count === 1 ? 1 : --itemInState.count\n      };\n      this._basket = [...this._basket.slice(0, itemInd), newItem, ...this._basket.slice(itemInd + 1)];\n    }\n\n    if (!isAuth) {\n      localStorage.setItem(\"basket\", JSON.stringify(this._basket));\n    }\n\n    let totalPrice = 0;\n\n    this._basket.forEach(device => totalPrice += Number(device.price * device.count));\n\n    this._totalPrice = totalPrice;\n  }\n\n  resetBasket() {\n    this._basket = [];\n    this._totalPrice = 0;\n    localStorage.removeItem('basket');\n  }\n\n  get Basket() {\n    return this._basket;\n  }\n\n  get Price() {\n    return this._totalPrice;\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Lenovo/Desktop/2/online-store-master/front/src/store/BasketStore.js"],"names":["makeAutoObservable","deleteDeviceFromBasket","BasketStoreStore","constructor","_totalPrice","_basket","setDeleteItemBasket","device","isAuth","id","then","filter","item","price","count","localStorage","setItem","JSON","stringify","setBasket","checkDeviceInBasket","findIndex","totalPrice","forEach","Number","setDeleteAllDeviceFromBasket","setCountDevice","deviceId","action","itemInd","itemInState","find","newItem","slice","resetBasket","removeItem","Basket","Price"],"mappings":"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","sourcesContent":["import {makeAutoObservable} from \"mobx\";\nimport {deleteDeviceFromBasket} from \"../http/deviceAPI\";\n\n\nexport default class BasketStoreStore {\n    constructor() {\n        this._totalPrice = 0;\n        this._basket = [];\n        makeAutoObservable(this);\n    }\n\n    async setDeleteItemBasket(device, isAuth = false) {\n        if(isAuth) {\n            await deleteDeviceFromBasket(device.id).then(() => {\n                this._basket = this._basket.filter(item => item.id !== device.id);\n                this._totalPrice -=  device.price * device.count;\n            });\n        } else {\n            this._basket = this._basket.filter(item => item.id !== device.id);\n            this._totalPrice -=  device.price * device.count;\n\n            localStorage.setItem(\"basket\", JSON.stringify(this._basket));\n        }\n    }\n\n    setBasket(item, isAuth = false) {\n        const checkDeviceInBasket = this._basket.findIndex(device => device.id === item.id);\n        if(checkDeviceInBasket < 0) {\n            this._basket = [...this._basket, { count: 1, ...item}];\n            let totalPrice = 0;\n            this._basket.forEach(device => totalPrice += Number(device.price * device.count));\n            this._totalPrice = totalPrice;\n        }\n\n        if(!isAuth) {\n            localStorage.setItem(\"basket\", JSON.stringify(this._basket));\n        }\n    }\n\n    setDeleteAllDeviceFromBasket() {\n        this._totalPrice = 0;\n        return this._basket = [];\n    }\n\n    setCountDevice(deviceId, action, isAuth = false) {\n        const itemInd = this._basket.findIndex(item => item.id === deviceId);\n        const itemInState = this._basket.find(device => device.id === deviceId);\n        if (action === \"+\") {\n            const newItem = {\n                ...itemInState,\n                count: ++itemInState.count\n            }\n            this._basket = [...this._basket.slice(0, itemInd), newItem, ...this._basket.slice(itemInd + 1)]\n        } else {\n            const newItem = {\n                ...itemInState,\n                count: itemInState.count === 1 ? 1 : --itemInState.count\n            }\n            this._basket = [...this._basket.slice(0, itemInd), newItem, ...this._basket.slice(itemInd + 1)]\n        }\n\n        if(!isAuth) {\n            localStorage.setItem(\"basket\", JSON.stringify(this._basket));\n        }\n\n        let totalPrice = 0;\n        this._basket.forEach(device => totalPrice += Number(device.price * device.count));\n        this._totalPrice = totalPrice;\n    }\n\n    resetBasket() {\n        this._basket = [];\n        this._totalPrice = 0;\n        localStorage.removeItem('basket');\n    }\n\n\n    get Basket() {\n        return this._basket;\n    }\n\n    get Price() {\n        return this._totalPrice;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}